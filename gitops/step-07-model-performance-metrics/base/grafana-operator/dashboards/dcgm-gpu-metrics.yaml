# Official NVIDIA DCGM Exporter Dashboard
# ============================================================================
# Source: https://github.com/NVIDIA/dcgm-exporter/blob/main/grafana/dcgm-exporter-dashboard.json
#
# This is the OFFICIAL NVIDIA dashboard for GPU monitoring.
#
# Panels include:
#   - GPU Temperature
#   - GPU Avg. Temp
#   - GPU Power Usage
#   - GPU Power Total
#   - GPU SM Clocks
#   - GPU Utilization
#   - GPU Framebuffer Mem Used
#   - Tensor Core Utilization
#
# Ref: https://docs.nvidia.com/datacenter/cloud-native/openshift/latest/enable-gpu-monitoring-dashboard.html
# Ref: https://github.com/NVIDIA/dcgm-exporter
# ============================================================================
apiVersion: grafana.integreatly.org/v1beta1
kind: GrafanaDashboard
metadata:
  name: dcgm-gpu-metrics
  namespace: private-ai
  labels:
    app: grafana
    dashboards: "grafana"
    app.kubernetes.io/part-of: observability
    app.kubernetes.io/component: observability
  annotations:
    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
    argocd.argoproj.io/sync-wave: "12"
spec:
  instanceSelector:
    matchLabels:
      dashboards: "grafana"
  
  # Reference the official NVIDIA DCGM dashboard from GitHub (raw URL to avoid redirects)
  url: "https://raw.githubusercontent.com/NVIDIA/dcgm-exporter/main/grafana/dcgm-exporter-dashboard.json"
  
  # Resync every 5 minutes to pick up any upstream updates
  resyncPeriod: 5m
