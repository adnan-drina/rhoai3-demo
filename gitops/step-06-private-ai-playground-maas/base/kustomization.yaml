apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Step 06: Private AI Playground & Model-as-a-Service (MaaS)
# Establishes the high-level consumption layer of the AI platform
#
# Architecture:
#   ┌─────────────────────────────────────────────────────────────────────────┐
#   │                     Enterprise AI Platform                              │
#   ├─────────────────────────────────────────────────────────────────────────┤
#   │                                                                         │
#   │   ┌─────────────────────────────────────────────────────────────────┐  │
#   │   │                  GenAI Studio (Playground UI)                    │  │
#   │   │   - Prompt engineering sandbox                                   │  │
#   │   │   - Model comparison                                            │  │
#   │   │   - Session management                                          │  │
#   │   └─────────────────────────────────────────────────────────────────┘  │
#   │                              │                                          │
#   │                              ▼                                          │
#   │   ┌─────────────────────────────────────────────────────────────────┐  │
#   │   │                    LlamaStack Backend                            │  │
#   │   │   - Orchestrates Playground actions                             │  │
#   │   │   - Translates UI to vLLM API calls                            │  │
#   │   │   - Manages conversation state                                  │  │
#   │   └─────────────────────────────────────────────────────────────────┘  │
#   │                                                                         │
#   │   ═══════════════════════════════════════════════════════════════════  │
#   │                                                                         │
#   │   ┌─────────────────────────────────────────────────────────────────┐  │
#   │   │             MaaS Gateway (Unified API Endpoint)                  │  │
#   │   │   URL: https://maas.apps.<cluster>/v1/...                       │  │
#   │   │                                                                  │  │
#   │   │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │  │
#   │   │   │  Authorino   │  │  Limitador   │  │    Router    │          │  │
#   │   │   │  (AuthZ)     │──│ (Rate Limit) │──│  (Model Sel) │          │  │
#   │   │   └──────────────┘  └──────────────┘  └──────────────┘          │  │
#   │   └─────────────────────────────────────────────────────────────────┘  │
#   │                              │                                          │
#   │                              ▼                                          │
#   │   ┌─────────────────────────────────────────────────────────────────┐  │
#   │   │                   InferenceServices (Step-05)                    │  │
#   │   │   mistral-3-bf16 │ mistral-3-int4 │ devstral-2 │ gpt-oss-20b   │  │
#   │   └─────────────────────────────────────────────────────────────────┘  │
#   │                                                                         │
#   └─────────────────────────────────────────────────────────────────────────┘
#
# Components:
#   1. playground/ - LlamaStack backend for GenAI Studio
#   2. maas/       - InferenceGateway + auth/rate-limiting
#
# Prerequisites:
#   - Step-05 InferenceServices deployed
#   - genAiStudio: true in OdhDashboardConfig (step-02)
#   - modelAsService: true in OdhDashboardConfig (step-02)
#   - llamastackoperator: Managed in DataScienceCluster (step-02)
#   - Authorino + Limitador operators installed (step-01)
#
# Ref: https://docs.redhat.com/en/documentation/red_hat_openshift_ai_self-managed/3.0/html-single/experimenting_with_models_in_the_gen_ai_playground/index
# Ref: https://opendatahub-io.github.io/models-as-a-service/latest/

resources:
  # ═══════════════════════════════════════════════════════════════════════════
  # 1. Playground Backend (LlamaStack) - sync-wave: 5
  # ═══════════════════════════════════════════════════════════════════════════
  - playground/

  # ═══════════════════════════════════════════════════════════════════════════
  # 2. Model-as-a-Service Gateway - sync-wave: 10
  # ═══════════════════════════════════════════════════════════════════════════
  - maas/

